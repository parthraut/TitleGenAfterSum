~/TitleGenAfterSum ~/TitleGenAfterSum
Requirement already satisfied: torch in ./venv/lib/python3.11/site-packages (2.1.0)
Requirement already satisfied: filelock in ./venv/lib/python3.11/site-packages (from torch) (3.13.1)
Requirement already satisfied: typing-extensions in ./venv/lib/python3.11/site-packages (from torch) (4.8.0)
Requirement already satisfied: sympy in ./venv/lib/python3.11/site-packages (from torch) (1.12)
Requirement already satisfied: networkx in ./venv/lib/python3.11/site-packages (from torch) (3.2.1)
Requirement already satisfied: jinja2 in ./venv/lib/python3.11/site-packages (from torch) (3.1.2)
Requirement already satisfied: fsspec in ./venv/lib/python3.11/site-packages (from torch) (2023.10.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in ./venv/lib/python3.11/site-packages (from torch) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in ./venv/lib/python3.11/site-packages (from torch) (12.1.105)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in ./venv/lib/python3.11/site-packages (from torch) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==8.9.2.26 in ./venv/lib/python3.11/site-packages (from torch) (8.9.2.26)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in ./venv/lib/python3.11/site-packages (from torch) (12.1.3.1)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in ./venv/lib/python3.11/site-packages (from torch) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in ./venv/lib/python3.11/site-packages (from torch) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in ./venv/lib/python3.11/site-packages (from torch) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in ./venv/lib/python3.11/site-packages (from torch) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.18.1 in ./venv/lib/python3.11/site-packages (from torch) (2.18.1)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in ./venv/lib/python3.11/site-packages (from torch) (12.1.105)
Requirement already satisfied: triton==2.1.0 in ./venv/lib/python3.11/site-packages (from torch) (2.1.0)
Requirement already satisfied: nvidia-nvjitlink-cu12 in ./venv/lib/python3.11/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch) (12.3.52)
Requirement already satisfied: MarkupSafe>=2.0 in ./venv/lib/python3.11/site-packages (from jinja2->torch) (2.1.3)
Requirement already satisfied: mpmath>=0.19 in ./venv/lib/python3.11/site-packages (from sympy->torch) (1.3.0)

[notice] A new release of pip is available: 23.2.1 -> 23.3.1
[notice] To update, run: pip install --upgrade pip
Requirement already satisfied: transformers in ./venv/lib/python3.11/site-packages (4.35.0)
Requirement already satisfied: filelock in ./venv/lib/python3.11/site-packages (from transformers) (3.13.1)
Requirement already satisfied: huggingface-hub<1.0,>=0.16.4 in ./venv/lib/python3.11/site-packages (from transformers) (0.17.3)
Requirement already satisfied: numpy>=1.17 in ./venv/lib/python3.11/site-packages (from transformers) (1.26.1)
Requirement already satisfied: packaging>=20.0 in ./venv/lib/python3.11/site-packages (from transformers) (23.2)
Requirement already satisfied: pyyaml>=5.1 in ./venv/lib/python3.11/site-packages (from transformers) (6.0.1)
Requirement already satisfied: regex!=2019.12.17 in ./venv/lib/python3.11/site-packages (from transformers) (2023.10.3)
Requirement already satisfied: requests in ./venv/lib/python3.11/site-packages (from transformers) (2.31.0)
Requirement already satisfied: tokenizers<0.15,>=0.14 in ./venv/lib/python3.11/site-packages (from transformers) (0.14.1)
Requirement already satisfied: safetensors>=0.3.1 in ./venv/lib/python3.11/site-packages (from transformers) (0.4.0)
Requirement already satisfied: tqdm>=4.27 in ./venv/lib/python3.11/site-packages (from transformers) (4.66.1)
Requirement already satisfied: fsspec in ./venv/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.16.4->transformers) (2023.10.0)
Requirement already satisfied: typing-extensions>=3.7.4.3 in ./venv/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.16.4->transformers) (4.8.0)
Requirement already satisfied: charset-normalizer<4,>=2 in ./venv/lib/python3.11/site-packages (from requests->transformers) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in ./venv/lib/python3.11/site-packages (from requests->transformers) (3.4)
Requirement already satisfied: urllib3<3,>=1.21.1 in ./venv/lib/python3.11/site-packages (from requests->transformers) (2.0.7)
Requirement already satisfied: certifi>=2017.4.17 in ./venv/lib/python3.11/site-packages (from requests->transformers) (2023.7.22)

[notice] A new release of pip is available: 23.2.1 -> 23.3.1
[notice] To update, run: pip install --upgrade pip
Requirement already satisfied: datasets in ./venv/lib/python3.11/site-packages (2.14.6)
Requirement already satisfied: numpy>=1.17 in ./venv/lib/python3.11/site-packages (from datasets) (1.26.1)
Requirement already satisfied: pyarrow>=8.0.0 in ./venv/lib/python3.11/site-packages (from datasets) (14.0.1)
Requirement already satisfied: dill<0.3.8,>=0.3.0 in ./venv/lib/python3.11/site-packages (from datasets) (0.3.7)
Requirement already satisfied: pandas in ./venv/lib/python3.11/site-packages (from datasets) (2.1.3)
Requirement already satisfied: requests>=2.19.0 in ./venv/lib/python3.11/site-packages (from datasets) (2.31.0)
Requirement already satisfied: tqdm>=4.62.1 in ./venv/lib/python3.11/site-packages (from datasets) (4.66.1)
Requirement already satisfied: xxhash in ./venv/lib/python3.11/site-packages (from datasets) (3.4.1)
Requirement already satisfied: multiprocess in ./venv/lib/python3.11/site-packages (from datasets) (0.70.15)
Requirement already satisfied: fsspec[http]<=2023.10.0,>=2023.1.0 in ./venv/lib/python3.11/site-packages (from datasets) (2023.10.0)
Requirement already satisfied: aiohttp in ./venv/lib/python3.11/site-packages (from datasets) (3.8.6)
Requirement already satisfied: huggingface-hub<1.0.0,>=0.14.0 in ./venv/lib/python3.11/site-packages (from datasets) (0.17.3)
Requirement already satisfied: packaging in ./venv/lib/python3.11/site-packages (from datasets) (23.2)
Requirement already satisfied: pyyaml>=5.1 in ./venv/lib/python3.11/site-packages (from datasets) (6.0.1)
Requirement already satisfied: attrs>=17.3.0 in ./venv/lib/python3.11/site-packages (from aiohttp->datasets) (23.1.0)
Requirement already satisfied: charset-normalizer<4.0,>=2.0 in ./venv/lib/python3.11/site-packages (from aiohttp->datasets) (3.3.2)
Requirement already satisfied: multidict<7.0,>=4.5 in ./venv/lib/python3.11/site-packages (from aiohttp->datasets) (6.0.4)
Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in ./venv/lib/python3.11/site-packages (from aiohttp->datasets) (4.0.3)
Requirement already satisfied: yarl<2.0,>=1.0 in ./venv/lib/python3.11/site-packages (from aiohttp->datasets) (1.9.2)
Requirement already satisfied: frozenlist>=1.1.1 in ./venv/lib/python3.11/site-packages (from aiohttp->datasets) (1.4.0)
Requirement already satisfied: aiosignal>=1.1.2 in ./venv/lib/python3.11/site-packages (from aiohttp->datasets) (1.3.1)
Requirement already satisfied: filelock in ./venv/lib/python3.11/site-packages (from huggingface-hub<1.0.0,>=0.14.0->datasets) (3.13.1)
Requirement already satisfied: typing-extensions>=3.7.4.3 in ./venv/lib/python3.11/site-packages (from huggingface-hub<1.0.0,>=0.14.0->datasets) (4.8.0)
Requirement already satisfied: idna<4,>=2.5 in ./venv/lib/python3.11/site-packages (from requests>=2.19.0->datasets) (3.4)
Requirement already satisfied: urllib3<3,>=1.21.1 in ./venv/lib/python3.11/site-packages (from requests>=2.19.0->datasets) (2.0.7)
Requirement already satisfied: certifi>=2017.4.17 in ./venv/lib/python3.11/site-packages (from requests>=2.19.0->datasets) (2023.7.22)
Requirement already satisfied: python-dateutil>=2.8.2 in ./venv/lib/python3.11/site-packages (from pandas->datasets) (2.8.2)
Requirement already satisfied: pytz>=2020.1 in ./venv/lib/python3.11/site-packages (from pandas->datasets) (2023.3.post1)
Requirement already satisfied: tzdata>=2022.1 in ./venv/lib/python3.11/site-packages (from pandas->datasets) (2023.3)
Requirement already satisfied: six>=1.5 in ./venv/lib/python3.11/site-packages (from python-dateutil>=2.8.2->pandas->datasets) (1.16.0)

[notice] A new release of pip is available: 23.2.1 -> 23.3.1
[notice] To update, run: pip install --upgrade pip
Requirement already satisfied: tqdm in ./venv/lib/python3.11/site-packages (4.66.1)

[notice] A new release of pip is available: 23.2.1 -> 23.3.1
[notice] To update, run: pip install --upgrade pip
Requirement already satisfied: numpy in ./venv/lib/python3.11/site-packages (1.26.1)

[notice] A new release of pip is available: 23.2.1 -> 23.3.1
[notice] To update, run: pip install --upgrade pip
Requirement already satisfied: evaluate in ./venv/lib/python3.11/site-packages (0.4.1)
Requirement already satisfied: datasets>=2.0.0 in ./venv/lib/python3.11/site-packages (from evaluate) (2.14.6)
Requirement already satisfied: numpy>=1.17 in ./venv/lib/python3.11/site-packages (from evaluate) (1.26.1)
Requirement already satisfied: dill in ./venv/lib/python3.11/site-packages (from evaluate) (0.3.7)
Requirement already satisfied: pandas in ./venv/lib/python3.11/site-packages (from evaluate) (2.1.3)
Requirement already satisfied: requests>=2.19.0 in ./venv/lib/python3.11/site-packages (from evaluate) (2.31.0)
Requirement already satisfied: tqdm>=4.62.1 in ./venv/lib/python3.11/site-packages (from evaluate) (4.66.1)
Requirement already satisfied: xxhash in ./venv/lib/python3.11/site-packages (from evaluate) (3.4.1)
Requirement already satisfied: multiprocess in ./venv/lib/python3.11/site-packages (from evaluate) (0.70.15)
Requirement already satisfied: fsspec[http]>=2021.05.0 in ./venv/lib/python3.11/site-packages (from evaluate) (2023.10.0)
Requirement already satisfied: huggingface-hub>=0.7.0 in ./venv/lib/python3.11/site-packages (from evaluate) (0.17.3)
Requirement already satisfied: packaging in ./venv/lib/python3.11/site-packages (from evaluate) (23.2)
Requirement already satisfied: responses<0.19 in ./venv/lib/python3.11/site-packages (from evaluate) (0.18.0)
Requirement already satisfied: pyarrow>=8.0.0 in ./venv/lib/python3.11/site-packages (from datasets>=2.0.0->evaluate) (14.0.1)
Requirement already satisfied: aiohttp in ./venv/lib/python3.11/site-packages (from datasets>=2.0.0->evaluate) (3.8.6)
Requirement already satisfied: pyyaml>=5.1 in ./venv/lib/python3.11/site-packages (from datasets>=2.0.0->evaluate) (6.0.1)
Requirement already satisfied: filelock in ./venv/lib/python3.11/site-packages (from huggingface-hub>=0.7.0->evaluate) (3.13.1)
Requirement already satisfied: typing-extensions>=3.7.4.3 in ./venv/lib/python3.11/site-packages (from huggingface-hub>=0.7.0->evaluate) (4.8.0)
Requirement already satisfied: charset-normalizer<4,>=2 in ./venv/lib/python3.11/site-packages (from requests>=2.19.0->evaluate) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in ./venv/lib/python3.11/site-packages (from requests>=2.19.0->evaluate) (3.4)
Requirement already satisfied: urllib3<3,>=1.21.1 in ./venv/lib/python3.11/site-packages (from requests>=2.19.0->evaluate) (2.0.7)
Requirement already satisfied: certifi>=2017.4.17 in ./venv/lib/python3.11/site-packages (from requests>=2.19.0->evaluate) (2023.7.22)
Requirement already satisfied: python-dateutil>=2.8.2 in ./venv/lib/python3.11/site-packages (from pandas->evaluate) (2.8.2)
Requirement already satisfied: pytz>=2020.1 in ./venv/lib/python3.11/site-packages (from pandas->evaluate) (2023.3.post1)
Requirement already satisfied: tzdata>=2022.1 in ./venv/lib/python3.11/site-packages (from pandas->evaluate) (2023.3)
Requirement already satisfied: attrs>=17.3.0 in ./venv/lib/python3.11/site-packages (from aiohttp->datasets>=2.0.0->evaluate) (23.1.0)
Requirement already satisfied: multidict<7.0,>=4.5 in ./venv/lib/python3.11/site-packages (from aiohttp->datasets>=2.0.0->evaluate) (6.0.4)
Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in ./venv/lib/python3.11/site-packages (from aiohttp->datasets>=2.0.0->evaluate) (4.0.3)
Requirement already satisfied: yarl<2.0,>=1.0 in ./venv/lib/python3.11/site-packages (from aiohttp->datasets>=2.0.0->evaluate) (1.9.2)
Requirement already satisfied: frozenlist>=1.1.1 in ./venv/lib/python3.11/site-packages (from aiohttp->datasets>=2.0.0->evaluate) (1.4.0)
Requirement already satisfied: aiosignal>=1.1.2 in ./venv/lib/python3.11/site-packages (from aiohttp->datasets>=2.0.0->evaluate) (1.3.1)
Requirement already satisfied: six>=1.5 in ./venv/lib/python3.11/site-packages (from python-dateutil>=2.8.2->pandas->evaluate) (1.16.0)

[notice] A new release of pip is available: 23.2.1 -> 23.3.1
[notice] To update, run: pip install --upgrade pip
Requirement already satisfied: scikit-learn in ./venv/lib/python3.11/site-packages (1.3.2)
Requirement already satisfied: numpy<2.0,>=1.17.3 in ./venv/lib/python3.11/site-packages (from scikit-learn) (1.26.1)
Requirement already satisfied: scipy>=1.5.0 in ./venv/lib/python3.11/site-packages (from scikit-learn) (1.11.3)
Requirement already satisfied: joblib>=1.1.1 in ./venv/lib/python3.11/site-packages (from scikit-learn) (1.3.2)
Requirement already satisfied: threadpoolctl>=2.0.0 in ./venv/lib/python3.11/site-packages (from scikit-learn) (3.2.0)

[notice] A new release of pip is available: 23.2.1 -> 23.3.1
[notice] To update, run: pip install --upgrade pip
Requirement already satisfied: peft in ./venv/lib/python3.11/site-packages (0.6.2)
Requirement already satisfied: numpy>=1.17 in ./venv/lib/python3.11/site-packages (from peft) (1.26.1)
Requirement already satisfied: packaging>=20.0 in ./venv/lib/python3.11/site-packages (from peft) (23.2)
Requirement already satisfied: psutil in ./venv/lib/python3.11/site-packages (from peft) (5.9.6)
Requirement already satisfied: pyyaml in ./venv/lib/python3.11/site-packages (from peft) (6.0.1)
Requirement already satisfied: torch>=1.13.0 in ./venv/lib/python3.11/site-packages (from peft) (2.1.0)
Requirement already satisfied: transformers in ./venv/lib/python3.11/site-packages (from peft) (4.35.0)
Requirement already satisfied: tqdm in ./venv/lib/python3.11/site-packages (from peft) (4.66.1)
Requirement already satisfied: accelerate>=0.21.0 in ./venv/lib/python3.11/site-packages (from peft) (0.24.1)
Requirement already satisfied: safetensors in ./venv/lib/python3.11/site-packages (from peft) (0.4.0)
Requirement already satisfied: huggingface-hub in ./venv/lib/python3.11/site-packages (from accelerate>=0.21.0->peft) (0.17.3)
Requirement already satisfied: filelock in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (3.13.1)
Requirement already satisfied: typing-extensions in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (4.8.0)
Requirement already satisfied: sympy in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (1.12)
Requirement already satisfied: networkx in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (3.2.1)
Requirement already satisfied: jinja2 in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (3.1.2)
Requirement already satisfied: fsspec in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (2023.10.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (12.1.105)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==8.9.2.26 in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (8.9.2.26)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (12.1.3.1)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.18.1 in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (2.18.1)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (12.1.105)
Requirement already satisfied: triton==2.1.0 in ./venv/lib/python3.11/site-packages (from torch>=1.13.0->peft) (2.1.0)
Requirement already satisfied: nvidia-nvjitlink-cu12 in ./venv/lib/python3.11/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch>=1.13.0->peft) (12.3.52)
Requirement already satisfied: regex!=2019.12.17 in ./venv/lib/python3.11/site-packages (from transformers->peft) (2023.10.3)
Requirement already satisfied: requests in ./venv/lib/python3.11/site-packages (from transformers->peft) (2.31.0)
Requirement already satisfied: tokenizers<0.15,>=0.14 in ./venv/lib/python3.11/site-packages (from transformers->peft) (0.14.1)
Requirement already satisfied: MarkupSafe>=2.0 in ./venv/lib/python3.11/site-packages (from jinja2->torch>=1.13.0->peft) (2.1.3)
Requirement already satisfied: charset-normalizer<4,>=2 in ./venv/lib/python3.11/site-packages (from requests->transformers->peft) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in ./venv/lib/python3.11/site-packages (from requests->transformers->peft) (3.4)
Requirement already satisfied: urllib3<3,>=1.21.1 in ./venv/lib/python3.11/site-packages (from requests->transformers->peft) (2.0.7)
Requirement already satisfied: certifi>=2017.4.17 in ./venv/lib/python3.11/site-packages (from requests->transformers->peft) (2023.7.22)
Requirement already satisfied: mpmath>=0.19 in ./venv/lib/python3.11/site-packages (from sympy->torch>=1.13.0->peft) (1.3.0)

[notice] A new release of pip is available: 23.2.1 -> 23.3.1
[notice] To update, run: pip install --upgrade pip
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Generating summarization inputs
  0%|          | 0/81 [00:00<?, ?it/s]100%|██████████| 81/81 [00:00<00:00, 605594.70it/s]
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
[nltk_data]   Package punkt is already up-to-date!
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[nltk_data]   Package punkt is already up-to-date!
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
[nltk_data]   Package punkt is already up-to-date!
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
    self.model.to(device)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
    param_applied = fn(param)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
[nltk_data]   Package punkt is already up-to-date!
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[nltk_data]   Package punkt is already up-to-date!
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[nltk_data]   Package punkt is already up-to-date!
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return super().to(*args, **kwargs)
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    self.model.to(device)
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[nltk_data]   Package punkt is already up-to-date!
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[nltk_data]   Package punkt is already up-to-date!
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
[nltk_data]   Package punkt is already up-to-date!
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
[nltk_data]   Package punkt is already up-to-date!
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
[nltk_data]   Package punkt is already up-to-date!
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
Traceback (most recent call last):
  File "<string>", line 1, in <module>
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
[nltk_data]   Package punkt is already up-to-date!
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[nltk_data]   Package punkt is already up-to-date!
[nltk_data]   Package punkt is already up-to-date!
-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
[nltk_data] Downloading package punkt to /home/mehars/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/sw/pkgs/arc/python/3.11.5/lib/python3.11/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 291, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 314, in <module>
    summarize_all()
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 262, in summarize_all
    test_summ_df = summarize_csv("data/atn-filtered-publication-section-test.csv")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/src/finetuning/train_bart.py", line 214, in summarize_csv
    reader = pipeline("summarization", model=model_path, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/__init__.py", line 1070, in pipeline
    return pipeline_class(model=model, framework=framework, task=task, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/text2text_generation.py", line 67, in __init__
    super().__init__(*args, **kwargs)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/pipelines/base.py", line 797, in __init__
    self.model.to(device)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/transformers/modeling_utils.py", line 2271, in to
    return super().to(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1160, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 810, in _apply
    module._apply(fn)
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 833, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/home/mehars/TitleGenAfterSum/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1158, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

-----------------------
Summarizing test
-----------------------
Creating All the News 2.0 Summarized dataset
-----------------------
Setting model and tokenizer
-----------------------
Reading CSV
